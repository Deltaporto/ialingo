Plano Detalhado: Refatoração para IAlingo (Tarefas Específicas)

Siga o seguinte plano, etapa por etapa (fase por fase, neste caso, para manter a resposta gerenciável). A cada fase concluída, apresente um resumo do que foi feito e o status atualizado do plano geral com checkboxes. Depois, atualize @plano.md

Fase 1: Definição da Nova Estrutura de Dados e Tipos (Total Aprox: 16 Tarefas)

1. Definir Tipos TypeScript:

Criar o arquivo src/types/ialingo.ts.

Definir e exportar a interface IModule.

Definir e exportar o enum TopicType (com os valores INTRO_MODULE, CONCEPT_EXPLANATION, etc.).

Definir e exportar a interface ITopic (incluindo topicType: TopicType, steps: IStep[]).

Definir e exportar a interface IStep (incluindo interactions: IInteraction[]).

Definir e exportar o enum InteractionType (com os valores MULTIPLE_CHOICE, SCENARIO_JUDGMENT, etc.).

Definir e exportar interfaces específicas para cada tipo de interação (ex: IMultipleChoiceInteractionData, IScenarioJudgmentInteractionData) que contenham as propriedades necessárias (opções, cenário, questão, etc.).

Definir e exportar a interface base IInteraction (com type: InteractionType, data: SpecificInteractionData).

Definir e exportar o enum TopicStatus ('LOCKED', 'ACTIVE', 'COMPLETE').

Revisar e garantir que todos os tipos estão corretamente relacionados e exportados.

2. Criar Estrutura de Dados de Conteúdo (Mock/Exemplo):

Criar o arquivo src/data/ialingoModules.ts.

Importar os tipos definidos em ialingo.ts.

Criar um array ialingoModulesData: IModule[].

Definir a estrutura completa para o primeiro Módulo (ex: Introdução), incluindo pelo menos 2-3 Topics de tipos diferentes.

Dentro desses Topics, definir Steps contendo pelo menos 3-4 tipos diferentes de Interactions (MULTIPLE_CHOICE, TRUE_FALSE, SCENARIO_JUDGMENT).

Definir a estrutura básica para um segundo Módulo (ex: Riscos Críticos), com 1-2 Topics e interações iniciais, para testar a navegação entre módulos.

3. Remover Dados Antigos:

Localizar o arquivo src/utils/units.ts.

Comentar todo o conteúdo do arquivo ou renomeá-lo (ex: units.ts.deprecated).

Buscar por todas as importações de src/utils/units.ts no projeto e removê-las ou atualizá-las (se aplicável, mas provavelmente serão removidas).

Verificar se a aplicação ainda compila após a remoção/comentário.

Fase 2: Refatoração da Navegação Principal e Exibição de Módulos/Tópicos (Total Aprox: 10 Tarefas)

1. Adaptar Página de Aprendizado (src/pages/learn.tsx):

Alterar a importação de dados para usar ialingoModulesData de src/data/ialingoModules.ts.

Renomear o componente UnitSection para ModuleSection (incluindo nome do arquivo/pasta se aplicável).

Atualizar as props de ModuleSection para receber module: IModule.

Dentro de ModuleSection, substituir a iteração sobre tiles por uma iteração sobre module.topics.

Refatorar a lógica de renderização do Tile para renderizar um componente TopicItem (ou similar), exibindo o título do tópico e um ícone baseado no topic.topicType.

Criar a função getTopicStatus(topicId: string, completedTopicIds: string[]): TopicStatus (lógica inicial simulada, será conectada ao store na Fase 5).

Atualizar/Renomear ou remover o componente TileTooltip para TopicTooltip, exibindo informações relevantes do ITopic.

Renomear/Adaptar o componente UnitHeader para ModuleHeader, exibindo o título do IModule.

Remover ou comentar botões/links não relevantes (Practice Exercise, Guidebook - será readicionado).

Atualizar o onClick do TopicItem para navegar para a página de lição (/lesson/[moduleId]/[topicId]) apenas se getTopicStatus retornar ACTIVE.

Fase 3: Refatoração da Página de Lição (lesson.tsx) para Tópicos/Passos/Interações (Total Aprox: 18 Tarefas)

1. Estrutura da Página (src/pages/lesson.tsx):

(Opcional) Renomear arquivo/componente para TopicPlayer.tsx.

Usar useRouter (ou similar) para obter moduleId e topicId dos parâmetros da rota.

Implementar lógica para buscar o ITopic correto de ialingoModulesData com base nos IDs. (Adicionar tratamento de erro se não encontrado).

Refatorar o estado do componente para gerenciar currentStepIndex: number.

2. Renderização de Passos e Interações:

Obter o IStep atual com base no currentStepIndex.

Mapear sobre as interactions do IStep atual. (Assumindo 1 interação por passo inicialmente para simplificar, ou ajustar para múltiplas se necessário).

Implementar um switch (interaction.type) dentro da renderização.

Para cada case no switch, renderizar um componente placeholder para o tipo de interação correspondente (ex: <MultipleChoiceInteraction data={interaction.data} />).

Garantir que a prop data está sendo passada corretamente para os placeholders.

3. Componentes de Interface da Lição:

Adaptar o componente ProgressBar para receber currentStepIndex e totalSteps = topic.steps.length e exibir o progresso no tópico.

Remover a lógica de hearts do ProgressBar e da UI.

Adaptar/Simplificar a mensagem de saída (QuitMessage).

Refatorar o componente CheckAnswer para InteractionFooter.

Remover o botão "Skip" do InteractionFooter.

Implementar a lógica do botão "Check"/"Continue" no InteractionFooter para: obter a resposta do componente de interação filho (via callback/estado compartilhado).

(Continuação Check/Continue): Validar a resposta (lógica de validação inicial/simulada).

(Continuação Check/Continue): Mostrar feedback visual temporário (certo/errado).

(Continuação Check/Continue): Se correto, incrementar currentStepIndex ou navegar para a conclusão se for o último passo.

Renomear e refatorar LessonComplete para TopicComplete.

Remover a exibição de XP e Lingots da tela TopicComplete.

Adicionar exibição de "Tempo Gasto" (valor fixo inicial) na tela TopicComplete.

Atualizar textos e design da tela TopicComplete para um tom profissional.

4. Remover Componentes Antigos:

Remover/Comentar os arquivos e usos de ProblemSelect1Of3 e ProblemWriteInEnglish.

Remover/Comentar os arquivos e usos de LessonFastForwardStart e LessonFastForwardEnd.

Fase 4: Implementação dos Componentes de Interação (Total Aprox: 10 Tarefas)

1. Criar Componentes React:

Criar a pasta src/components/interactions/.

Criar o componente MultipleChoiceInteraction.tsx. Implementar a UI para exibir a pergunta e as opções (botões/radios). Gerenciar o estado da opção selecionada. Expor a seleção via callback (onSelectAnswer).

Criar o componente TrueFalseInteraction.tsx. Implementar UI com botões "Verdadeiro"/"Falso". Gerenciar estado. Expor seleção via callback.

Criar o componente ScenarioJudgmentInteraction.tsx. Exibir o cenário e a pergunta. Usar botões/radios para as opções de julgamento. Gerenciar estado. Expor seleção via callback.

Criar o componente MultiSelectInteraction.tsx. Exibir pergunta e opções (checkboxes). Gerenciar estado das seleções (array). Expor seleções via callback.

Criar o componente RiskIdentifierInteraction.tsx. Exibir cenário/texto. Apresentar lista de riscos (checkboxes). Gerenciar estado. Expor seleções via callback.

Criar o componente DoDontSortInteraction.tsx. Apresentar lista de ações. Permitir classificação (ex: drag-and-drop ou botões "Do"/"Don't"). Gerenciar estado. Expor classificação via callback.

(Opcional) Criar ShortReflectionInteraction.tsx. Exibir pergunta. Renderizar um textarea. Gerenciar estado do texto. Expor texto via callback (para possível registro, sem validação automática).

2. Integração:

Importar os componentes de interação reais em lesson.tsx (ou TopicPlayer.tsx).

Substituir os placeholders no switch pelos componentes reais, passando as props (data e a função de callback para receber a resposta).

Implementar a lógica no InteractionFooter para receber a resposta do componente de interação ativo e usá-la na validação.

Fase 5: Adaptação do Gerenciamento de Estado e Progresso (Total Aprox: 10 Tarefas)

1. Refatorar Store (src/stores/createLessonStore.ts):

Renomear o arquivo e o slice do Zustand para createProgressStore.ts / progressSlice.

Substituir o estado lessonsCompleted: number por completedTopicIds: string[].

Remover completamente os estados xp e lingots.

Remover as actions increaseXp e increaseLingots.

Renomear/Adaptar a action increaseLessonsCompleted para markTopicAsComplete(topicId: string), que adiciona o topicId ao array completedTopicIds.

Remover ou adaptar a action jumpToUnit (ex: unlockNextModule(), se necessário).

(Opcional) Adicionar estado comprehensionScores: Record<string, number> para guardar pontuações por módulo/tópico.

(Opcional) Adicionar estado timeSpent: Record<string, number> para guardar tempo gasto por tópico.

Revisar e garantir que o estado inicial (initialState) está correto.

Garantir que o estado é persistido (se usando persist middleware do Zustand).

2. Atualizar Uso do Store:

Em learn.tsx, importar e usar completedTopicIds do progressStore para alimentar a função getTopicStatus.

Em lesson.tsx (ou TopicPlayer.tsx), ao finalizar o último passo corretamente, chamar a action markTopicAsComplete(currentTopicId) do store.

Na tela TopicComplete, buscar e exibir as métricas relevantes do progressStore (ex: tempo gasto no tópico, se implementado).

Verificar se a barra de progresso geral (se houver, na LeftBar talvez) reflete o número de tópicos completos.

Testar a persistência do progresso ao recarregar a página.

Fase 6: Implementação de Recursos de Apoio e Limpeza Geral (Total Aprox: 19 Tarefas)

1. Criar Guia de Referência:

Criar o arquivo para a página/componente (ex: src/pages/reference.tsx).

Implementar uma estrutura básica com seções (ex: Conceitos Chave, Riscos, Regras de Ouro).

Adicionar conteúdo de placeholder formatado em cada seção.

Criar um componente ReferenceGuideButton (ou similar).

Adicionar o ReferenceGuideButton em um local acessível (ex: TopBar ou LeftBar).

Implementar a lógica para abrir o Guia (navegação de página ou modal).

2. Remoção de Código e Assets:

Identificar e remover todos os SVGs não utilizados da pasta public/icons/ (ou onde estiverem).

Identificar e remover assets de imagem não utilizados (ex: womanPng) da pasta public/images/.

Fazer uma busca por funções utilitárias em src/utils/ que sejam específicas de idioma ou Duolingo e removê-las.

Remover componentes visuais claramente gamificados que não foram tratados antes (ex: efeitos sonoros específicos, animações excessivas).

3. Atualização de Terminologia e Branding:

Fazer busca global por "Duolingo" e substituir por "IAlingo" ou remover.

Fazer busca global por "lesson" e substituir por "Tópico" ou "Passo" conforme contexto.

Fazer busca global por "unit" e substituir por "Módulo".

Fazer busca global por "tile" e substituir por "Tópico".

Fazer busca global por "XP", "lingots", "hearts" e remover.

Fazer busca global por nomes de idiomas ("Spanish", "English") e remover.

Substituir o arquivo public/logo.svg (ou similar) pelo logo do IAlingo.

Substituir o public/favicon.ico (ou similar).

Atualizar o title no public/index.html (ou onde for definido).

4. Ajustes de Estilo (Tailwind):

Definir/Confirmar a paleta de cores profissional (azuis, cinzas) em tailwind.config.js.

Aplicar as cores primárias/secundárias aos elementos principais (Header, Sidebar, Botões primários).

Aplicar cores neutras (cinzas) para fundos, bordas e textos secundários.

Revisar e ajustar estilos de botões para um visual mais sóbrio.

Revisar e ajustar estilos de cards/seções (padding, sombras sutis, bordas).

Verificar e padronizar fontes (tamanhos, pesos).

Remover classes de Tailwind que criam efeitos excessivamente "gamificados" (ex: gradientes vibrantes não alinhados, sombras internas fortes).

Verificar a aplicação em modo escuro (se houver) e ajustar cores/contraste.

Fase 7: Integração do Conteúdo Real (Pós-Refatoração) (Total Aprox: 8 Tarefas)

1. Popular Estrutura de Dados:

Obter o conteúdo finalizado para o Módulo 1.

Converter o conteúdo do Módulo 1 para a estrutura IModule, ITopic, IStep, IInteraction no arquivo ialingoModules.ts, substituindo o mock.

Repetir o processo para o Módulo 2.

Repetir o processo para todos os Módulos restantes.

Validar a estrutura do ialingoModules.ts contra os tipos TypeScript (tsc --noEmit pode ajudar).

Verificar se todas as interações têm os dados necessários (opções corretas, textos, etc.).

Formatar o arquivo de dados para melhor legibilidade.

Testar o carregamento e exibição inicial do conteúdo real na aplicação.

Fase 8: Revisão e Testes (Total Aprox: 11 Tarefas)

1. Revisão de Código:

Realizar uma revisão de código focada nas novas estruturas de tipos e dados (Fase 1).

Revisar a lógica de navegação e renderização principal (Fase 2).

Revisar a lógica complexa da página de lição/tópico (Fase 3 e 4).

Revisar a implementação do gerenciamento de estado (Fase 5).

Revisar as limpezas e ajustes de estilo (Fase 6).

2. Linting e Type Checking:

Executar o linter configurado (ex: ESLint) e corrigir todos os avisos/erros.

Executar tsc --noEmit e corrigir todos os erros de tipo.

3. Testes Manuais:

Realizar um fluxo completo: Abrir a aplicação, navegar pelos módulos, iniciar um tópico ACTIVE, completar todos os passos/interações, verificar a tela de conclusão e o avanço do progresso.

Testar especificamente cada InteractionType implementado, verificando a lógica de validação e feedback.

Testar os estados LOCKED, ACTIVE, COMPLETE dos tópicos (navegação, aparência visual).

Testar a persistência do progresso (recarregar a página).

Acessar e verificar a funcionalidade básica do Guia de Referência.

Avaliar a consistência visual, terminologia e tom profissional em toda a aplicação.

Testar em diferentes resoluções de tela (ex: Desktop e Tablet simulado no browser).

Essa quebra transforma o plano em um checklist muito mais detalhado, facilitando a distribuição de tarefas e o acompanhamento do progresso da refatoração.